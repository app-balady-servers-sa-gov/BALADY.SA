<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام إنشاء الشهادات الصحية - البلدي</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2E7D32;
            --secondary-color: #4CAF50;
            --accent-color: #FF9800;
            --light-color: #E8F5E9;
            --dark-color: #1B5E20;
            --gray-color: #f5f5f5;
            --text-color: #333;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            --header-height: 80px;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', 'Tahoma', 'Geneva', 'Verdana', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            border-radius: 20px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
            height: var(--header-height);
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }
        
        .logo {
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 15px;
        }
        
        .logo i {
            font-size: 2rem;
            color: var(--primary-color);
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .content {
            display: flex;
            flex-wrap: wrap;
            padding: 30px;
        }
        
        .form-section {
            flex: 1;
            min-width: 350px;
            padding: 20px;
            background: var(--light-color);
            border-radius: 15px;
            margin-left: 20px;
        }
        
        .preview-section {
            flex: 1;
            min-width: 350px;
            padding: 20px;
            background-color: var(--gray-color);
            border-radius: 15px;
            position: relative;
        }
        
        .section-title {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary-color);
            font-size: 1.5rem;
            display: flex;
            align-items: center;
        }
        
        .section-title i {
            margin-left: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--dark-color);
        }
        
        input[type="text"],
        input[type="number"],
        input[type="file"],
        select,
        textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            background: white;
        }
        
        input[type="text"]:focus,
        input[type="number"]:focus,
        input[type="file"]:focus,
        select:focus,
        textarea:focus {
            border-color: var(--secondary-color);
            outline: none;
            box-shadow: 0 0 8px rgba(76, 175, 80, 0.4);
        }
        
        .file-upload {
            background-color: var(--light-color);
            padding: 20px;
            border-radius: 10px;
            border: 2px dashed var(--secondary-color);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-upload:hover {
            background-color: #dcedc8;
            transform: translateY(-2px);
        }
        
        .file-upload i {
            font-size: 2.5rem;
            color: var(--secondary-color);
            margin-bottom: 10px;
        }
        
        .btn {
            background: linear-gradient(to right, var(--accent-color), #FF5722);
            color: white;
            border: none;
            padding: 18px 30px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin: 20px 0;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn i {
            margin-left: 10px;
        }
        
        .btn:hover {
            background: linear-gradient(to right, #F57C00, #E64A19);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        .btn-primary {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
        }
        
        .btn-primary:hover {
            background: linear-gradient(to right, #1B5E20, #2E7D32);
        }
        
        .preview-box {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            min-height: 400px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .preview-image {
            width: 220px;
            height: 220px;
            border-radius: 10px;
            border: 4px solid var(--secondary-color);
            margin-bottom: 25px;
            object-fit: cover;
            background: linear-gradient(135deg, #e0e0e0 0%, #f5f5f5 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #888;
            font-size: 14px;
            text-align: center;
            padding: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .preview-content {
            width: 100%;
        }
        
        .preview-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        
        .preview-item strong {
            color: var(--dark-color);
        }
        
        .instructions {
            background-color: var(--light-color);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-right: 4px solid var(--secondary-color);
        }
        
        .instructions ul {
            padding-right: 20px;
            margin-top: 10px;
        }
        
        .instructions li {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .instructions li i {
            margin-left: 10px;
            color: var(--secondary-color);
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 25px;
            border-top: 1px solid #ddd;
            color: #777;
            background-color: #f9f9f9;
        }
        
        @media (max-width: 992px) {
            .content {
                flex-direction: column;
            }
            
            .form-section {
                margin-left: 0;
                margin-bottom: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
        }
        
        .certificate-type {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .certificate-type label {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 12px 20px;
            background: white;
            border-radius: 10px;
            border: 2px solid #ddd;
            transition: all 0.3s;
        }
        
        .certificate-type label:hover {
            border-color: var(--secondary-color);
        }
        
        .certificate-type input {
            margin-left: 8px;
        }
        
        .certificate-type input:checked + span {
            color: var(--primary-color);
            font-weight: bold;
        }
        
        .qr-code {
            margin-top: 25px;
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }
        
        .qr-code canvas {
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 10px;
            background: white;
            margin: 0 auto;
        }
        
        .success-alert {
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--secondary-color);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 1000;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .progress-bar {
            height: 5px;
            background: var(--primary-color);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 10px;
            margin-top: 10px;
        }
        
        .github-config {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <div class="logo">
                    <i class="fas fa-certificate"></i>
                </div>
                <div>
                    <h1>نظام الشهادات الصحية - البلدي</h1>
                    <p class="subtitle">منصة متكاملة لإنشاء وإدارة الشهادات الصحية</p>
                </div>
            </div>
        </header>
        
        <div class="instructions">
            <h2><i class="fas fa-info-circle"></i> إرشادات استخدام النظام</h2>
            <p>يرجى اتباع الخطوات التالية لإكمال عملية إنشاء الشهادة الصحية:</p>
            <ul>
                <li><i class="fas fa-check-circle"></i> املأ جميع الحقول الإلزامية المشار إليها بعلامة (*)</li>
                <li><i class="fas fa-check-circle"></i> اختر صورة شخصية مناسبة من جهازك</li>
                <li><i class="fas fa-check-circle"></i> اختر نوع الشهادة المطلوبة</li>
                <li><i class="fas fa-check-circle"></i> اضغط على زر "إنشاء الشهادة" عند الانتهاء</li>
                <li><i class="fas fa-check-circle"></i> سيتم حفظ الشهادة ورمز QR تلقائياً</li>
            </ul>
        </div>
        
        <div class="content">
            <div class="form-section">
                <h2 class="section-title"><i class="fas fa-edit"></i> معلومات الشهادة</h2>
                
                <form id="healthCertificateForm">
                    <div class="form-group">
                        <label>نوع الشهادة *</label>
                        <div class="certificate-type">
                            <label>
                                <input type="radio" name="certificateType" value="شهادة صحية موحدة" checked>
                                <span>شهادة صحية موحدة</span>
                            </label>
                            <label>
                                <input type="radio" name="certificateType" value="شهادة صحية سنوية">
                                <span>شهادة صحية سنوية</span>
                            </label>
                            <label>
                                <input type="radio" name="certificateType" value="ح-سنوية">
                                <span>ح-سنوية</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="photo">الصورة الشخصية *</label>
                        <div class="file-upload" id="photoUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>انقر لتحميل الصورة الشخصية</p>
                            <input type="file" id="photo" name="photo" accept="image/*" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="secretariat">الأمانة *</label>
                        <input type="text" id="secretariat" name="secretariat" required placeholder="اسم الأمانة">
                    </div>
                    
                    <div class="form-group">
                        <label for="municipality">البلدية *</label>
                        <input type="text" id="municipality" name="municipality" required placeholder="اسم البلدية">
                    </div>
                    
                    <div class="form-group">
                        <label for="name">الاسم الكامل *</label>
                        <input type="text" id="name" name="name" required placeholder="أدخل الاسم الثلاثي">
                    </div>
                    
                    <div class="form-group">
                        <label for="idNumber">رقم الهوية *</label>
                        <input type="number" id="idNumber" name="idNumber" required placeholder="رقم الهوية أو الإقامة">
                    </div>
                    
                    <div class="form-group">
                        <label for="gender">الجنس *</label>
                        <select id="gender" name="gender" required>
                            <option value="">اختر الجنس</option>
                            <option value="ذكر">ذكر</option>
                            <option value="أنثى">أنثى</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="nationality">الجنسية *</label>
                        <input type="text" id="nationality" name="nationality" required placeholder="الجنسية">
                    </div>
                    
                    <div class="form-group">
                        <label for="profession">المهنة *</label>
                        <input type="text" id="profession" name="profession" required placeholder="المهنة الحالية">
                    </div>
                    
                    <div class="form-group">
                        <label for="establishmentName">اسم المنشأة *</label>
                        <input type="text" id="establishmentName" name="establishmentName" required placeholder="اسم المنشأة أو المؤسسة">
                    </div>
                    
                    <div class="form-group">
                        <label for="establishmentNumber">رقم المنشأة *</label>
                        <input type="text" id="establishmentNumber" name="establishmentNumber" required placeholder="رقم ترخيص المنشأة">
                    </div>
                    
                    <div class="form-group">
                        <label for="programType">نوع البرنامج التثقيفي *</label>
                        <input type="text" id="programType" name="programType" required placeholder="أدخل نوع البرنامج التثقيفي">
                    </div>
                    
                    <div class="form-group">
                        <label for="licenseNumber">رقم الرخصة *</label>
                        <input type="text" id="licenseNumber" name="licenseNumber" required placeholder="رقم الرخصة المهنية">
                    </div>
                    
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-certificate"></i> إنشاء الشهادة الصحية
                    </button>
                </form>
            </div>
            
            <div class="preview-section">
                <h2 class="section-title"><i class="fas fa-eye"></i> معاينة الشهادة</h2>
                
                <div class="preview-box">
                    <div class="preview-image" id="previewImage">
                        <span>سيظهر هنا معاينة الصورة الشخصية</span>
                    </div>
                    
                    <div class="preview-content">
                        <div class="preview-item">
                            <strong>نوع الشهادة:</strong>
                            <span id="previewType">شهادة صحية موحدة</span>
                        </div>
                        <div class="preview-item">
                            <strong>الاسم:</strong>
                            <span id="previewName">الاسم الكامل</span>
                        </div>
                        <div class="preview-item">
                            <strong>الأمانة:</strong>
                            <span id="previewSecretariat">غير محدد</span>
                        </div>
                        <div class="preview-item">
                            <strong>البلدية:</strong>
                            <span id="previewMunicipality">غير محدد</span>
                        </div>
                        <div class="preview-item">
                            <strong>رقم الهوية:</strong>
                            <span id="previewIdNumber">غير محدد</span>
                        </div>
                        <div class="preview-item">
                            <strong>الجنس:</strong>
                            <span id="previewGender">غير محدد</span>
                        </div>
                        <div class="preview-item">
                            <strong>الجنسية:</strong>
                            <span id="previewNationality">غير محدد</span>
                        </div>
                        <div class="preview-item">
                            <strong>المهنة:</strong>
                            <span id="previewProfession">غير محدد</span>
                        </div>
                        <div class="preview-item">
                            <strong>اسم المنشأة:</strong>
                            <span id="previewEstablishment">غير محدد</span>
                        </div>
                        <div class="preview-item">
                            <strong>رقم المنشأة:</strong>
                            <span id="previewEstablishmentNumber">غير محدد</span>
                        </div>
                        <div class="preview-item">
                            <strong>نوع البرنامج:</strong>
                            <span id="previewProgram">غير محدد</span>
                        </div>
                        <div class="preview-item">
                            <strong>رقم الرخصة:</strong>
                            <span id="previewLicense">غير محدد</span>
                        </div>
                        <div class="preview-item">
                            <strong>رقم الشهادة:</strong>
                            <span id="previewCertificateNumber">سيتم توليده تلقائياً</span>
                        </div>
                    </div>
                </div>
                
                <div class="qr-code">
                    <h3><i class="fas fa-qrcode"></i> رمز QR للشهادة</h3>
                    <div id="qrcode"></div>
                    <div class="progress-bar" id="progressBar"></div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>جميع الحقوق محفوظة © 2023 - نظام الشهادات الصحية الموحدة - أمانة منطقة جازان</p>
            <p>تم التطوير باستخدام أحدث التقنيات المتوافقة مع جميع الأجهزة</p>
        </div>
    </div>

    <div class="success-alert" id="successAlert">
        <i class="fas fa-check-circle"></i> تم إنشاء الشهادة الصحية بنجاح!
    </div>

    <div class="github-config">
        <!-- إعدادات GitHub المخفية -->
        <div id="githubOwner">app-balady-servers-sa-gov</div>
        <div id="githubRepo">BALADY.SA</div>
        <div id="githubBranch">main</div>
        <div id="githubToken">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</div>
    </div>

    <script>
        // إعدادات GitHub (مخفية عن المستخدم)
        const GITHUB_OWNER = document.getElementById('githubOwner').textContent;
        const GITHUB_REPO = document.getElementById('githubRepo').textContent;
        const GITHUB_BRANCH = document.getElementById('githubBranch').textContent;
        const GITHUB_TOKEN = document.getElementById('githubToken').textContent;
        
        // توليد رقم الشهادة العشوائي
        function generateCertificateNumber() {
            return "40" + Math.floor(1000000000 + Math.random() * 9000000000).toString().substring(0, 10);
        }
        
        // الحصول على التواريخ المطلوبة
        function getDates() {
            const today = new Date();
            const todayGregorian = today.toISOString().split('T')[0].replace(/-/g, '/');
            
            // حساب تاريخ الانتهاء بعد سنة
            const nextYear = new Date(today);
            nextYear.setFullYear(nextYear.getFullYear() + 1);
            const endGregorian = nextYear.toISOString().split('T')[0].replace(/-/g, '/');
            
            // حساب تاريخ انتهاء البرنامج بعد 3 سنوات
            const programYear = new Date(today);
            programYear.setFullYear(programYear.getFullYear() + 3);
            const programGregorian = programYear.toISOString().split('T')[0].replace(/-/g, '/');
            
            // هنا يجب إضافة تحويل إلى الهجري باستخدام مكتبة مناسبة
            // للتبسيط، سنستخدم تواريخ افتراضية
            const todayHijri = "1445/03/15";
            const endHijri = "1446/03/15";
            const programHijri = "1448/03/15";
            
            return {
                today_gregorian: todayGregorian,
                end_gregorian: endGregorian,
                today_hijri: todayHijri,
                end_hijri: endHijri,
                program_hijri: programHijri,
                program_gregorian: programGregorian
            };
        }
        
        // معالجة تحميل الصورة وعرض معاينة لها
        document.getElementById('photoUpload').addEventListener('click', function() {
            document.getElementById('photo').click();
        });
        
        document.getElementById('photo').addEventListener('change', function(e) {
            if (e.target.files && e.target.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const previewImage = document.getElementById('previewImage');
                    previewImage.innerHTML = '';
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.style.width = '100%';
                    img.style.height = '100%';
                    img.style.objectFit = 'cover';
                    img.style.borderRadius = '6px';
                    previewImage.appendChild(img);
                }
                reader.readAsDataURL(e.target.files[0]);
            }
        });
        
        // تحديث المعاينة عند إدخال البيانات
        const updatePreview = () => {
            document.getElementById('previewName').textContent = document.getElementById('name').value || 'الاسم الكامل';
            
            const certificateType = document.querySelector('input[name="certificateType"]:checked').value;
            document.getElementById('previewType').textContent = certificateType;
            
            document.getElementById('previewSecretariat').textContent = document.getElementById('secretariat').value || 'غير محدد';
            document.getElementById('previewMunicipality').textContent = document.getElementById('municipality').value || 'غير محدد';
            document.getElementById('previewIdNumber').textContent = document.getElementById('idNumber').value || 'غير محدد';
            document.getElementById('previewGender').textContent = document.getElementById('gender').value || 'غير محدد';
            document.getElementById('previewNationality').textContent = document.getElementById('nationality').value || 'غير محدد';
            document.getElementById('previewProfession').textContent = document.getElementById('profession').value || 'غير محدد';
            document.getElementById('previewEstablishment').textContent = document.getElementById('establishmentName').value || 'غير محدد';
            document.getElementById('previewEstablishmentNumber').textContent = document.getElementById('establishmentNumber').value || 'غير محدد';
            document.getElementById('previewProgram').textContent = document.getElementById('programType').value || 'غير محدد';
            document.getElementById('previewLicense').textContent = document.getElementById('licenseNumber').value || 'غير محدد';
            
            // توليد رقم الشهادة وعرضه
            const certificateNumber = generateCertificateNumber();
            document.getElementById('previewCertificateNumber').textContent = certificateNumber;
            
            // إنشاء رمز QR
            const qrCodeElement = document.getElementById('qrcode');
            qrCodeElement.innerHTML = '';
            
            const certificateUrl = `https://${GITHUB_OWNER}.github.io/${GITHUB_REPO}/${certificateNumber}`;
            
            QRCode.toCanvas(qrCodeElement, certificateUrl, {
                width: 150,
                margin: 1,
                color: {
                    dark: '#2E7D32',
                    light: '#FFFFFF'
                }
            }, function(error) {
                if (error) console.error(error);
            });
        };
        
        // إضافة مستمعات الأحداث لحقول الإدخال
        const inputFields = ['name', 'secretariat', 'municipality', 'idNumber', 'gender', 'nationality', 
                            'profession', 'establishmentName', 'establishmentNumber', 'programType', 'licenseNumber'];
        
        inputFields.forEach(field => {
            document.getElementById(field).addEventListener('input', updatePreview);
        });
        
        document.querySelectorAll('input[name="certificateType"]').forEach(radio => {
            radio.addEventListener('change', updatePreview);
        });
        
        // معالجة إرسال النموذج
        document.getElementById('healthCertificateForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // عرض مؤشر التقدم
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = '30%';
            
            // توليد رقم الشهادة
            const certificateNumber = generateCertificateNumber();
            
            // الحصول على التواريخ
            const dates = getDates();
            
            // جمع البيانات
            const certificateType = document.querySelector('input[name="certificateType"]:checked').value;
            
            const formData = {
                certificateType: certificateType,
                secretariat: document.getElementById('secretariat').value,
                municipality: document.getElementById('municipality').value,
                name: document.getElementById('name').value,
                idNumber: document.getElementById('idNumber').value,
                gender: document.getElementById('gender').value,
                nationality: document.getElementById('nationality').value,
                profession: document.getElementById('profession').value,
                establishmentName: document.getElementById('establishmentName').value,
                establishmentNumber: document.getElementById('establishmentNumber').value,
                programType: document.getElementById('programType').value,
                licenseNumber: document.getElementById('licenseNumber').value,
                certificateNumber: certificateNumber,
                today_gregorian: dates.today_gregorian,
                end_gregorian: dates.end_gregorian,
                today_hijri: dates.today_hijri,
                end_hijri: dates.end_hijri
            };
            
            // إذا كان نوع الشهادة ليس "شهادة صحية موحدة"، لا نضيف تاريخ انتهاء البرنامج
            if (certificateType === "شهادة صحية موحدة") {
                formData.program_hijri = dates.program_hijri;
                formData.program_gregorian = dates.program_gregorian;
            }
            
            progressBar.style.width = '60%';
            
            // محاكاة عملية الحفظ (في الواقع سيتم رفع الملف إلى GitHub)
            try {
                // محاكاة التأخير
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                // هنا سيتم إضافة كود رفع الملف إلى GitHub
                // const success = await uploadToGitHub(formData, certificateNumber);
                const success = true; // محاكاة النجاح
                
                progressBar.style.width = '100%';
                
                if (success) {
                    // عرض رسالة النجاح
                    const successAlert = document.getElementById('successAlert');
                    successAlert.style.display = 'block';
                    
                    // إخفاء رسالة النجاح بعد 5 ثوان
                    setTimeout(() => {
                        successAlert.style.display = 'none';
                    }, 5000);
                    
                    // إعادة تعيين شريط التقدم
                    setTimeout(() => {
                        progressBar.style.width = '0%';
                    }, 1000);
                }
            } catch (error) {
                console.error('Error:', error);
                alert('حدث خطأ أثناء إنشاء الشهادة. يرجى المحاولة مرة أخرى.');
                progressBar.style.width = '0%';
            }
        });
        
        // تحسينات للأجهزة التي تعمل باللمس
        if ('ontouchstart' in window) {
            document.body.classList.add('touch-device');
            
            // تحسينات إضافية للأجهزة التي تعمل باللمس
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                input.addEventListener('focus', function() {
                    this.style.fontSize = '18px';
                });
                
                input.addEventListener('blur', function() {
                    this.style.fontSize = '16px';
                });
            });
        }
        
        // دالة محاكاة رفع الملف إلى GitHub
        async function uploadToGitHub(data, certificateNumber) {
            // في الواقع، هنا سيتم استخدام GitHub API لرفع الملف
            // const response = await fetch(`https://api.github.com/repos/${GITHUB_OWNER}/${GITHUB_REPO}/contents/${certificateNumber}.html`, {
            //     method: 'PUT',
            //     headers: {
            //         'Authorization': `token ${GITHUB_TOKEN}`,
            //         'Content-Type': 'application/json'
            //     },
            //     body: JSON.stringify({
            //         message: `Add health certificate ${certificateNumber}`,
            //         content: btoa(JSON.stringify(data)),
            //         branch: GITHUB_BRANCH
            //     })
            // });
            
            // return response.ok;
            
            // محاكاة النجاح
            return true;
        }
        
        // تهيئة أولية للمعاينة
        updatePreview();
    </script>
</body>
</html>